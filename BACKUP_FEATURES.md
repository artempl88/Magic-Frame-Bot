# üíæ –°–∏—Å—Ç–µ–º–∞ –±—ç–∫–∞–ø–æ–≤ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –±–æ—Ç–∞

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å —Ä—É—á–Ω—ã–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–∑–¥–∞–Ω–∏–µ–º –±—ç–∫–∞–ø–æ–≤.

## üéØ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—ç–∫–∞–ø–∞–º–∏ (`services/backup_service.py`)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–∂–∞—Ç—ã—Ö –±—ç–∫–∞–ø–æ–≤ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –°–ø–∏—Å–æ–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—ç–∫–∞–ø–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
- ‚úÖ –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î (—Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏)

### 2. –ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å (`bot/handlers/admin.py`)
- ‚úÖ –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ "üíæ –ë—ç–∫–∞–ø—ã –ë–î" –≤ –∞–¥–º–∏–Ω–∫–µ
- ‚úÖ –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –±—ç–∫–∞–ø–æ–≤
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º –±—ç–∫–∞–ø–µ
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—ç–∫–∞–ø–æ–≤
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (>30 –¥–Ω–µ–π)
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã (Docker Compose)
- ‚úÖ **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00 UTC** - –æ—Å–Ω–æ–≤–Ω—ã–µ –±—ç–∫–∞–ø—ã
- ‚úÖ **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 2:00 UTC** - –ø–æ–ª–Ω—ã–µ –±—ç–∫–∞–ø—ã (VPS)
- ‚úÖ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –≤ 4:00 UTC** - —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±—ç–∫–∞–ø–∞ (—Ä–∞–∑–º–µ—Ä, –¥–∞—Ç–∞, –æ–ø–∏—Å–∞–Ω–∏–µ)

### 4. –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Makefile.client)
- ‚úÖ `backup-auto` - —Å–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
- ‚úÖ `backup-list` - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±—ç–∫–∞–ø–æ–≤
- ‚úÖ `backup-cleanup` - –æ—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã
- ‚úÖ `backup-size` - –ø–æ–∫–∞–∑–∞—Ç—å –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä
- ‚úÖ `up-backup` - –∑–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –±—ç–∫–∞–ø–∞–º–∏
- ‚úÖ `vps-up-backup` - VPS –∑–∞–ø—É—Å–∫ —Å –±—ç–∫–∞–ø–∞–º–∏

## üïê –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±—ç–∫–∞–ø–æ–≤

| –í—Ä–µ–º—è | –î–µ–π—Å—Ç–≤–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| **2:00 –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ** | –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –±—ç–∫–∞–ø | –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø (—Ç–æ–ª—å–∫–æ VPS) |
| **3:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ** | –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø | –û—Å–Ω–æ–≤–Ω–æ–π –∞–≤—Ç–æ–±—ç–∫–∞–ø |
| **4:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ** | –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ | –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ >30 –¥–Ω–µ–π |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—ç–∫–∞–ø–æ–≤

```
./backups/
‚îú‚îÄ‚îÄ auto_backup_20240120_030000.sql.gz       # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π
‚îú‚îÄ‚îÄ auto_backup_20240120_030000.sql.gz.meta  # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ weekly_backup_20240121_020000.sql.gz     # –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –ø–æ–ª–Ω—ã–π  
‚îú‚îÄ‚îÄ weekly_backup_20240121_020000.sql.gz.meta
‚îú‚îÄ‚îÄ backup_20240120_143022.sql.gz            # –†—É—á–Ω–æ–π –∏–∑ –∞–¥–º–∏–Ω–∫–∏
‚îî‚îÄ‚îÄ backup_20240120_143022.sql.gz.meta
```

## üõ†Ô∏è –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –±–æ—Ç–∞:
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/admin`
2. –ù–∞–∂–º–∏—Ç–µ `üíæ –ë—ç–∫–∞–ø—ã –ë–î` 
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ

### –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É:
```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø —Å–µ–π—á–∞—Å
make -f Makefile.client backup-auto

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫
make -f Makefile.client backup-list

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –∞–≤—Ç–æ–±—ç–∫–∞–ø–∞–º–∏
make -f Makefile.client up-backup
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –±—ç–∫–∞–ø–∞–º–∏
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–ª—è –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å –±—ç–∫–∞–ø–∞–º–∏
- ‚úÖ –°–∂–∞—Ç–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤

## üìä –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±—ç–∫–∞–ø–æ–≤

–ö–∞–∂–¥—ã–π –±—ç–∫–∞–ø —Å–æ–¥–µ—Ä–∂–∏—Ç JSON-—Ñ–∞–π–ª —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏:
```json
{
  "created_at": "2024-01-20T14:30:22",
  "description": "–†—É—á–Ω–æ–π –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º",
  "size": 1048576,
  "database": "client_bot",
  "user": "botuser"
}
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Docker –ø—Ä–æ—Ñ–∏–ª–∏:

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
docker-compose -f docker-compose.simple.yml --profile backup up -d

# –ù–∞ VPS  
docker-compose -f docker-compose.client.yml --profile backup up -d
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –±—ç–∫–∞–ø–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –±—ç–∫–∞–ø–∞–º–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ Telegram, –∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. 